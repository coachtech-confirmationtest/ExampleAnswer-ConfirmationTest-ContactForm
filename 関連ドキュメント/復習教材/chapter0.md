# Chapter 0: はじめてのLaravelアプリケーション開発 - 要件を理解し、全体像を掴む

## 🎯 このセクションで学ぶこと

このチャプターでは、これから開発する「お問い合わせ管理システム」の全体像を掴むことを目標とします。具体的には、どのような機能を実装する必要があるのか（**要件**）、どのような技術を使って開発を進めるのか、そして最終的にどのようなアプリケーションが完成するのかを学びます。ここでの理解が、今後の開発の羅針盤となります。

## 1. はじめに

### この確認テストの目的

この確認テストは、単に動くアプリケーションを作ることだけが目的ではありません。実務で通用するWebアプリケーション開発の一連の流れを体験し、**「なぜこの技術を使うのか」「なぜこの設計にするのか」**という理由を理解しながら、自走できるエンジニアになるための基礎体力を養うことを目的としています。

### 学習のゴール

この復習教材を通して、あなたは以下のことができるようになります。

- Laravelを使った基本的なWebアプリケーションの設計と実装ができる。
- 要件を読み解き、必要な機能を洗い出し、実装に落とし込むことができる。
- データベースの設計、モデルのリレーション、APIの実装といったバックエンド開発の基本を習得する。
- 実務で頻出する問題（N+1問題など）を理解し、その解決策を実装できる。
- エラーや問題に直面した際に、自力で調査し解決に導くための「調べ方」を身につける。

最終的には、お問い合わせフォームから送信された内容を管理者が閲覧・検索できる、実践的なWebアプリケーションをゼロから構築します。

## 2. 要件の確認

まず、私たちがこれから作る「お問い合わせ管理システム」に求められる機能（要件）を具体的に見ていきましょう。要件は、ユーザーがアプリケーションに求める機能や振る舞いを定義したものです。家を建てる前の設計図のように、開発の方向性を定める重要な役割を果たします。

このシステムには、大きく分けて**基本機能**と**応用機能**の2つのレベルがあります。まずは基本機能の要件をしっかりと理解しましょう。

### 基本機能の要件

| 機能分類 | 機能名 | 詳細な仕様 |
| :--- | :--- | :--- |
| **ユーザー向け機能** | お問い合わせフォーム | - 氏名、性別、メールアドレス、電話番号、住所、お問い合わせの種類、お問い合わせ内容を入力できる。<br>- 入力内容の確認画面を表示できる。<br>- バリデーション（入力チェック）機能がある。<br>- フォームを送信すると、データベースにお問い合わせ内容が保存される。 |
| | お問い合わせ完了画面 | - お問い合わせ送信後、「お問い合わせありがとうございました」というメッセージを表示する。 |
| **管理者向け機能** | ログイン機能 | - 管理者専用のログイン画面からログインできる。<br>- 認証されていないユーザーは管理画面にアクセスできない。 |
| | 管理画面 | - 登録されたお問い合わせを一覧で表示する（ページネーション付き）。<br>- キーワード、性別、お問い合わせの種類、日付で絞り込み検索ができる。<br>- 各お問い合わせの詳細をモーダルウィンドウで表示できる。<br>- 特定のお問い合わせを削除できる。 |

### データベースの設計

上記の機能を実現するために、どのような情報をデータベースに保存する必要があるかを考えます。これがデータベース設計です。

| テーブル名 | カラム名 | データ型 | 役割と制約 |
| :--- | :--- | :--- | :--- |
| `users` | - | - | 管理者のアカウント情報を格納します。（Laravelの認証機能が自動で作成） |
| `categories` | `id` | `BIGINT` (PK) | カテゴリーID |
| | `content` | `VARCHAR` | お問い合わせの種類（例: 商品について、その他） |
| `contacts` | `id` | `BIGINT` (PK) | お問い合わせID |
| | `category_id` | `BIGINT` (FK) | `categories`テーブルと紐づく外部キー |
| | `first_name` | `VARCHAR` | 姓 |
| | `last_name` | `VARCHAR` | 名 |
| | `gender` | `TINYINT` | 性別（1:男性, 2:女性, 3:その他） |
| | `email` | `VARCHAR` | メールアドレス |
| | `tel` | `VARCHAR` | 電話番号（ハイフンなし10〜11桁） |
| | `address` | `VARCHAR` | 住所 |
| | `building` | `VARCHAR` | 建物名（任意入力） |
| | `detail` | `VARCHAR` | お問い合わせ内容（最大120文字） |

## 3. 先輩エンジニアの思考プロセス

要件が固まったところで、経験豊富なエンジニアがどのように実装計画を立てるのか、その思考プロセスを覗いてみましょう。コードを書き始める前に、このような「設計の思考」を理解することが、手戻りの少ない効率的な開発に繋がります。

### Point 1: まずは「データの入れ物」から考える

Webアプリケーション開発の基本は、**データ**です。どんな機能を作るにしても、まずは「どんなデータを」「どこに」「どのように保存するか」を考えます。今回の要件で言えば、「お問い合わせ情報」や「カテゴリー情報」がそれに当たります。これを実現するのが**データベース**と**マイグレーション**です。Laravelのマイグレーション機能を使えば、PHPコードでデータベースの構造を定義でき、誰が実行しても同じ構造のテーブルを再現できます。これは、チーム開発において非常に重要な機能です。

### Point 2: データとプログラムを繋ぐ「通訳者」を用意する

データベース（MySQLなど）とPHPのプログラムは、直接会話することができません。そこで登場するのが**モデル (Model)** です。モデルは、データベースのテーブルとPHPのオブジェクトを対応させ、データの読み書きをスムーズに行うための「通訳者」のような役割を果たします。Laravelでは、この仕組みを**Eloquent ORM**と呼びます。Eloquentのおかげで、私たちはSQLを直接書かなくても、PHPのコードで直感的にデータベースを操作できるのです。

### Point 3: 「関所の番人」で不正なデータを防ぐ

ユーザーからの入力は、常に正しいとは限りません。意図しない形式のデータや、悪意のあるコードが送られてくる可能性もあります。そこで、不正なデータがシステムに入り込む前にチェックする「関所の番人」が必要になります。これが**バリデーション**です。Laravelでは、**FormRequest**という機能を使うことで、バリデーションのルールをコントローラーから分離し、コードを綺麗に保つことができます。「電話番号は11桁以内」「メールアドレスの形式が正しいか」といったルールをここで定義します。

### Point 4: 役割分担を徹底し、見通しを良くする (MVCアーキテクチャ)

アプリケーションが複雑になるほど、コードが色々な場所に散らばり、修正や機能追加が困難になります。これを防ぐために、Laravelでは**MVC (Model-View-Controller)** という設計パターンを採用しています。

- **Model**: データの処理を担当（データベースとのやり取りなど）
- **View**: ユーザーに見える部分（HTML）を担当
- **Controller**: ModelとViewの橋渡し役。ユーザーからのリクエストを受け取り、Modelに指示を出し、結果をViewに渡す司令塔。

このように役割を明確に分けることで、それぞれの責務が明確になり、コードの見通しが格段に良くなります。今回の開発でも、このMVCを意識して実装を進めていきます。

### Point 5: フロントエンドとバックエンドを分離する (API)

今回のシステムでは、管理画面の検索や詳細表示といった動的な処理をJavaScriptで行います。このとき、JavaScript（フロントエンド）は、必要なデータ（例: 検索結果）をサーバー（バックエンド）に要求します。このやり取りの窓口となるのが**API (Application Programming Interface)** です。バックエンドはAPIを通じて、HTMLを含まない純粋なデータ（JSON形式）だけをフロントエンドに返します。これにより、フロントエンドとバックエンドの開発を分離でき、それぞれが独立して開発・修正を進められるようになります。これはモダンなWeb開発の主流なスタイルです。

## 4. 提供されているBladeファイルの確認

この確認テストでは、画面の見た目を定義する**Bladeファイル**は事前に提供されています。これにより、私たちはバックエンドのロジック実装に集中することができます。どのようなファイルが提供されているか、一度確認しておきましょう。

| ファイルパス | 役割 |
| :--- | :--- |
| `resources/views/contact/index.blade.php` | お問い合わせフォーム画面 |
| `resources/views/contact/thanks.blade.php` | お問い合わせ完了画面 |
| `resources/views/admin/index.blade.php` | 管理者用の管理画面 |
| `resources/views/auth/login.blade.php` | ログイン画面 |
| `resources/views/auth/register.blade.php` | 新規ユーザー登録画面 |
| `resources/views/layouts/app.blade.php` | 認証後の共通レイアウト |
| `resources/views/layouts/guest.blade.php` | 未認証時の共通レイアウト |

これらのファイルが、私たちの作るバックエンドの機能と連携して、一つのWebアプリケーションとして動作します。

## 5. まとめ

このチャプターでは、これから開発する「お問い合わせ管理システム」の要件と、その実装に向けた全体像を学びました。

- **何を（What）**: お問い合わせフォームと、その内容を管理するシステムを作る。
- **なぜ（Why）**: 実務に近い開発フローを体験し、自走できるエンジニアになるため。
- **どうやって（How）**: LaravelのMVCアーキテクチャに則り、データベース、モデル、コントローラー、APIなどを段階的に実装していく。

次のチャプターでは、いよいよ開発の第一歩として、開発環境の構築を行います。料理を始める前の、キッチン準備のようなものです。ここを乗り越えれば、楽しいコーディングが待っています。
